var obj,url=$request.url,change=!1;try{obj=JSON.parse($response.body)}catch(t){console.log(t+"\n错误URL："+url),$done({})}if(url.includes("app.bilibili.com/x/v2/splash/list")){if(obj.data?.list){for(let t of obj.data.list)t.duration=0,t.begin_time=2240150400,t.end_time=2240150400;change=!0}}else if(url.includes("app.bilibili.com/x/v2/feed/index?")){if(obj.data?.items){let t=[];for(let i of obj.data.items)i.hasOwnProperty("banner_item")||i.hasOwnProperty("ad_info")||-1!==i.card_goto.indexOf("ad")||"small_cover_v2"!==i.card_type&&"large_cover_v1"!==i.card_type&&"large_cover_single_v9"!==i.card_type||t.push(i);obj.data.items=t,change=!0}}else if(url.includes("app.bilibili.com/x/v2/feed/index/story?")){if(obj.data?.items){let t=[];for(let i of obj.data.items)i.hasOwnProperty("ad_info")||-1!==i.card_goto.indexOf("ad")||t.push(i);obj.data.items=t,change=!0}}else if(url.includes("app.bilibili.com/x/resource/show/tab"))if(obj.data?.tab?.length<4)obj.data.tab.push({id:1411,tab_id:"bangumi",name:"动画",uri:"bilibili://following/home_activity_tab/6544",pos:4}),change=!0;else{const t=new Set([39,40,41,774,857,545,151,442,99,100,101,554,556]),i=new Set([176,107]),a=new Set([177,178,179,181,102,104,106,486,488,489]);obj.data?.tab&&(obj.data.tab=obj.data.tab.filter((i=>t.has(i.id))),change=!0);let e="246834163";obj.data?.top&&(obj.data.top=obj.data.top.filter((t=>(222!==t.id&&107!==t.id||(t.uri=`bilibili://story/${e}`,t.icon="https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/script/bilibili/bilibili_icon.png",t.tab_id="Story_Top",t.name="Story"),i.has(t.id)))),change=!0),obj.data?.bottom&&(obj.data.bottom=obj.data.bottom.filter((t=>a.has(t.id))),change=!0)}else if(url.includes("app.bilibili.com/x/v2/account/mine")){if(obj.data?.sections_v2){const t=new Set([396,397,398,399,402,404,407,410,425,426,427,428,430,432,433,434,494,495,496,497,500,501]);obj.data.sections_v2.forEach(((i,a)=>{i.items.forEach((t=>{622===t.id&&(t.title="会员购",t.uri="bilibili://mall/home")}));let e=i.items.filter((i=>t.has(i.id)));obj.data.sections_v2[a].button={},obj.data.sections_v2[a].be_up_title=void 0,obj.data.sections_v2[a].tip_icon=void 0,obj.data.sections_v2[a].tip_title=void 0;for(let t=0;t<obj.data.sections_v2.length;t++)"创作中心"!=obj.data.sections_v2[t].title&&"創作中心"!=obj.data.sections_v2[t].title||(obj.data.sections_v2[t].title=void 0,obj.data.sections_v2[t].type=void 0);obj.data.vip_section_v2=void 0,obj.data.vip_section=void 0,obj.data.sections_v2[a].items=e,obj.data.hasOwnProperty("live_tip")&&(obj.data.live_tip={}),obj.data.hasOwnProperty("answer")&&(obj.data.answer={}),obj.data.vip_type=2,obj.data.vip.type=2,obj.data.vip.status=1,obj.data.vip.vip_pay_type=1,obj.data.vip.due_date=4669824160})),change=!0}}else url.includes("app.bilibili.com/x/v2/account/myinfo?")?obj.data?.vip&&(obj.data.vip.type=2,obj.data.vip.status=1,obj.data.vip.vip_pay_type=1,obj.data.vip.due_date=4669824160,change=!0):url.includes("app.bilibili.com/x/v2/search/square")?(obj.data={type:"history",title:"搜索历史",search_hotword_revision:2},change=!0):url.includes("api.live.bilibili.com/xlive/app-room/v1/index/getInfoByRoom")?obj.data&&(obj.data.activity_banner_info=void 0,change=!0):url.includes("pgc/page/bangumi")||url.includes("pgc/page/cinema/tab?")?obj.result?.modules&&(obj.result.modules.forEach((t=>{t.style.startsWith("banner")&&(t.items=t.items.filter((t=>!(-1==t.link.indexOf("play"))))),t.style.startsWith("function")&&(t.items=t.items.filter((t=>-1==t.blink.indexOf("www.bilibili.com")))),t.style.startsWith("tip")&&(t.items=[])})),change=!0):console.log("触发意外的请求，请确认脚本或复写配置是否正常");change?$done({body:JSON.stringify(obj)}):$done({});