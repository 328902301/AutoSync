/*
脚本功能:WarpPanel for Surge
脚本描述:一款可以验证Warp,显示IP和流量的面板 @Functional_Store_Hub

脚本作者:R·E
脚本发布:https://t.me/Functional_Store_Hub

更新时间:2022.08.28
使用声明:⚠️⚠️⚠️转载需注明 Functional Store Hub 频道⚠️⚠️⚠️
*/

const _0xf1e05e='Functional_Store_Hub-WarpPanel';!(async()=>{if($script['type']!='generic'){var _0x306545=_0x19f52c(JSON['stringify']($request['headers']),$request['url']);if(_0x306545!=null){$persistentStore['write'](_0x306545,_0xf1e05e);$notification['post']('WarpPanel信息获取成功!','Warp信息已写入到持久化存储中','');$done();}else{$notification['post']('WarpPanel信息获取失败','Warp信息未写入到持久化存储中','');$done();}}else{var _0x941dc7=_0x3e630f(await _0x586a8d(_0x3671c6(_0xf1e05e)));var _0x4b946c='{\x22url\x22:\x22https://cloudflare.com/cdn-cgi/trace\x22,\x22headers\x22:{\x22user-agent\x22:\x22Mozilla/5.0\x20(Macintosh;\x20Intel\x20Mac\x20OS\x20X\x2012_3_1)\x20AppleWebKit/537.36\x20(KHTML,\x20like\x20Gecko)\x20Chrome/100.0.4896.60\x20Safari/537.36\x22}}';var _0x589b02=_0x318003(await _0x586a8d(_0x4b946c));$done({'title':'𝑾𝒂𝒓𝒑\x20𝑷𝒂𝒏𝒆𝒍+','content':_0x589b02+'\x0a'+_0x941dc7,'icon':'scribble.variable'});}})()['catch'](_0x1353b7=>{console['log'](String(_0x1353b7));throw new Error(_0x1353b7);})['finally'](()=>$done());function _0x3671c6(_0x246637){var _0x249af0=$persistentStore['read'](_0x246637);if(!_0x249af0){$notification['post']('WarpPanel信息获取失败','请先打开\x201.1.1.1\x20获取Warp信息!','打开\x201.1.1.1\x20后会自动获取并提示');$done();}_0x249af0=JSON['parse'](_0x249af0);var _0x4409fd=new Object();_0x4409fd['url']=_0x249af0['url'];_0x4409fd['headers']={};_0x4409fd['headers']['cookie']=_0x249af0['cookie'];_0x4409fd['headers']['user-agent']=_0x249af0['user-agent'];_0x4409fd['headers']['authorization']=_0x249af0['authorization'];return JSON['stringify'](_0x4409fd);}function _0x586a8d(_0x1885af){return new Promise(_0x4b0521=>{$httpClient['get'](JSON['parse'](_0x1885af),(_0x44b01e,_0x44381f,_0x362ce2)=>{try{if(_0x44b01e){throw new Error('请求信息错误\x0a错误内容:'+String(_0x44b01e));}else if(_0x362ce2){_0x4b0521(_0x362ce2);}}catch(_0x1554f5){console['log'](String(_0x1554f5));throw new Error('捕捉到请求信息错误\x0a错误内容:'+String(_0x1554f5));}finally{_0x4b0521();}});});}function _0x19f52c(_0x874fff,_0x556aa2){var _0x31a58f=JSON['parse'](_0x874fff);if(!_0x31a58f['cookie']&&!_0x31a58f['user-agent']&&!_0x31a58f['authorization']){$notification['post']('WarpPanel信息获取失败','Warp信息中的某项为空!','');return null;}var _0x1daa04=new Object();_0x1daa04['url']=_0x556aa2;_0x1daa04['cookie']=_0x31a58f['cookie'];_0x1daa04['user-agent']=_0x31a58f['user-agent'];_0x1daa04['authorization']=_0x31a58f['authorization'];return JSON['stringify'](_0x1daa04);}function _0x3e630f(_0x50b05c){if(!_0x50b05c){$done({'title':'𝑾𝒂𝒓𝒑\x20𝑷𝒂𝒏𝒆𝒍+','content':'WarpInfo为空!','icon':'scribble.variable'});}var _0xe5b12b=JSON['parse'](_0x50b05c);if(_0xe5b12b['result']['account']['account_type']=='limited'){return'使用流量:\x20'+parseInt((_0xe5b12b['result']['account']['premium_data']-_0xe5b12b['result']['account']['quota'])/0x400/0x400/0x400)+'GB\x0a剩余流量:\x20'+parseInt(_0xe5b12b['result']['account']['quota']/0x400/0x400/0x400)+'GB\x0a总计流量:\x20'+parseInt(_0xe5b12b['result']['account']['premium_data']/0x400/0x400/0x400)+'GB';}else if(_0xe5b12b['result']['account']['account_type']=='team'){return'使用流量:\x20Team\x20无限制\x0a剩余流量:\x20Team\x20无限制\x0a总计流量:\x20Team\x20无限制';}else{return'未知类型,请向\x20@R·E\x20反馈!';}}function _0x318003(_0x5909c4){if(!_0x5909c4){$done({'title':'𝑾𝒂𝒓𝒑\x20𝑷𝒂𝒏𝒆𝒍+','content':'WarpApiInfo为空!','icon':'scribble.variable'});}var _0x444f18=_0x5909c4['match'](/[\s\S]*ip\=(.*)[\s\S]*warp\=(\w+)/);var _0x5f1a15='';if(_0x444f18[0x2]=='off'){_0x5f1a15='没有';}else if(_0x444f18[0x2]=='on'){_0x5f1a15='部分';}else if(_0x444f18[0x2]=='plus'){_0x5f1a15='完全';}else{_0x5f1a15='未知';}return'IP信息:\x20'+_0x444f18[0x1]+'\x0aWarp+保护隐私:\x20'+_0x5f1a15;}
