#>2023.2.1
#💡 通用设置
[General]
#开启或关闭旁路系统
bypass-system = true

#开启或关闭ipv6支持
ipv6 = false

#开启或关闭首选ipv6支持
prefer-ipv6 = false

#私有ip应答，如关闭域名解析会返回私有ip，会认为该域名被劫持而强制使用代理
private-ip-answer = false

#设置dns服务器，并发请求选取最优结果
dns-server = system,https://dns.alidns.com/dns-query, https://doh.pub/dns-query

#劫持dns服务器，获得假ip地址
hijack-dns = 8.8.8.8:53, 1.1.1.1:53

#跳过代理或者ip段，不经过代理
skip-proxy = 10.0.0.0/8, 17.0.0.0/8, 100.64.0.0/10, 172.16.0.0/12, 192.168.0.0/16

#指定ip段范围绕过tun旁路由
tun-excluded-routes = 10.0.0.0/8,100.64.0.0/10,127.0.0.0/8,169.254.0.0/16,172.16.0.0/12,192.0.0.0/24,192.0.2.0/24,192.88.99.0/24,192.168.0.0/16,198.18.0.0/15,198.51.100.0/24,203.0.113.0/24,224.0.0.0/4,255.255.255.255/32

#配置的域名不会进行映射，返回真实的ip
always-real-ip = *.lan, *.local, localhost, *.msftconnecttest.com, *.msftncsi.com, *.jegotrip.com.cn, *.icitymobile.mobi, *.cmpassport.com, cable.auth.com, captive.apple.com, id6.me, open.e.189.cn, mdn.open.wo.cn, opencloud.wostore.cn, auth.wosms.cn

#💡 策略组分流
[Proxy Group]
pick = select,auto,hongkong,taiwan,japan,korea,singapore,america,chinese,DIRECT,PROXY,REJECT,interval=600,timeout=5,select=0,url=http://www.gstatic.com/generate_204
auto = url-test,url=http://www.gstatic.com/generate_204,interval=600,tolerance=150,timeout=5,select=0,policy-regex-filter=*
hongkong = url-test,url=http://www.gstatic.com/generate_204,interval=600,tolerance=150,timeout=5,select=0,policy-regex-filter=港|香港|🇭🇰|HK|Hong
taiwan = url-test,url=http://www.gstatic.com/generate_204,interval=600,tolerance=150,timeout=5,select=0,policy-regex-filter=台|台湾|台北|🇹🇼|TW|Taiwan
japan = url-test,url=http://www.gstatic.com/generate_204,interval=600,tolerance=150,timeout=5,select=0,policy-regex-filter=日本|川日|东京|大阪|泉日|埼玉|沪日|深日|🇯🇵|JP|Japan
korea = url-test,url=http://www.gstatic.com/generate_204,interval=600,tolerance=150,timeout=5,select=0,policy-regex-filter=韩国|韓國|朝鲜|🇰🇷|KR|Korea
singapore = url-test,url=http://www.gstatic.com/generate_204,interval=600,tolerance=150,timeout=5,select=0,policy-regex-filter=新加坡|狮城|🇸🇬|SG|Singapore
america = url-test,url=http://www.gstatic.com/generate_204,interval=600,tolerance=150,timeout=5,select=0,policy-regex-filter=美|美国|美國|波特兰|达拉斯|俄勒冈|凤凰城|费利蒙|硅谷|拉斯维加斯|洛杉矶|圣何塞|圣克拉拉|西雅图|芝加哥|🇺🇸|US|America
chinese = url-test,url=http://www.gstatic.com/generate_204,interval=600,tolerance=100,timeout=5,select=0,policy-regex-filter=移动|联通|电信|腾讯|阿里|🇨🇳|CN|CHINA|中国|国内|华东|华南|华中|华西|华北|北京|上海|重庆|天津|广东|广州|深圳|湖北|武汉|宜昌|江苏|南京|无锡|镇江|苏州|浙江|杭州|宁波|温州|绍兴|云南|昆明|贵州|贵阳|四川|成都|福建|福州|厦门|海南|海口|湖南|长沙|安徽|合肥|江西|南昌|河南|郑州|河北|石家庄|山东|济南|山西|太原|陕西|西安|辽宁|沈阳|吉林|长春|广西|南宁|宁夏|银川|青海|西宁|甘肃|兰州|黑龙江|哈尔滨|辽宁|沈阳|内蒙古|呼和浩特|新疆|乌鲁木齐|西藏|拉萨
speedtest = select,china,pick,interval=600,timeout=5,select=0,url=http://www.gstatic.com/generate_204
tiktok = select,pick,hongkong,taiwan,japan,korea,singapore,america,interval=600,timeout=5,select=0,url=http://www.gstatic.com/generate_204
telegram = select,pick,hongkong,taiwan,japan,korea,singapore,america,interval=600,timeout=5,select=0,url=http://www.gstatic.com/generate_204
spotify = select,pick,hongkong,taiwan,japan,korea,singapore,america,interval=600,timeout=5,select=0,url=http://www.gstatic.com/generate_204
netflix = select,pick,hongkong,taiwan,japan,korea,singapore,america,interval=600,timeout=5,select=0,url=http://www.gstatic.com/generate_204
disney = select,pick,hongkong,taiwan,japan,korea,singapore,america,interval=600,timeout=5,select=0,url=http://www.gstatic.com/generate_204
youtube = select,pick,hongkong,taiwan,japan,korea,singapore,america,interval=600,timeout=5,select=0,url=http://www.gstatic.com/generate_204
facebook = select,pick,hongkong,taiwan,japan,korea,singapore,america,interval=600,timeout=5,select=0,url=http://www.gstatic.com/generate_204
google = select,pick,hongkong,taiwan,japan,korea,singapore,america,interval=600,timeout=5,select=0,url=http://www.gstatic.com/generate_204
microsoft = select,china,pick,hongkong,taiwan,japan,korea,singapore,america,interval=600,timeout=5,select=0,url=http://www.gstatic.com/generate_204
apple = select,china,pick,hongkong,taiwan,japan,korea,singapore,america,interval=600,timeout=5,select=0,url=http://www.gstatic.com/generate_204
streaming = select,pick,hongkong,taiwan,japan,korea,singapore,america,interval=600,timeout=5,select=0,url=http://www.gstatic.com/generate_204
global = select,pick,hongkong,taiwan,japan,korea,singapore,america,interval=600,timeout=5,select=0,url=http://www.gstatic.com/generate_204
media = select,china,pick,interval=600,timeout=5,select=0,url=http://www.gstatic.com/generate_204
china = select,DIRECT,PROXY,REJECT,pick,chinese,interval=600,timeout=5,select=0,url=http://www.gstatic.com/generate_204
final = select,pick,china,adblock,interval=600,timeout=5,select=0,url=http://www.gstatic.com/generate_204
adblock = select,REJECT,DIRECT,interval=600,timeout=5,select=0,url=http://www.gstatic.com/generate_204

#💡 远程分流规则
[Rule]
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Direct/Direct.list,china
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Hijacking/Hijacking.list,adblock
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Privacy/Privacy.list,adblock
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/AdvertisingLite/AdvertisingLite.list,adblock
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Speedtest/Speedtest.list,speedtest
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/TikTok/TikTok.list,tiktok
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Telegram/Telegram.list,telegram
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Spotify/Spotify.list,spotify
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Netflix/Netflix.list,netflix
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Disney/Disney.list,disney
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/YouTube/YouTube.list,youtube
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/SystemOTA/SystemOTA.list,adblock
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Facebook/Facebook.list,facebook
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Google/Google.list,google
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Microsoft/Microsoft.list,microsoft
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Apple/Apple.list,apple
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/GlobalMedia/GlobalMedia.list,streaming
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Global/Global.list,global
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/ChinaMedia/ChinaMedia.list,media
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/China/China.list,china
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/ChinaIPs/ChinaIPs.list,china
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/ChinaIPsBGP/ChinaIPsBGP.list,china
GEOIP,CN,china
FINAL,final

#💡 对域名指定单独的dns服务器
[Host]
# alibaba
*.1688.com = server:223.5.5.5
*.tmall.com = server:223.5.5.5
*.taobao.com = server:223.5.5.5
*.alibaba.cn = server:223.5.5.5
*.alibaba.com.cn = server:223.5.5.5
*.alipay.com = server:223.5.5.5
*.alipay.com.cn = server:223.5.5.5
*.alipaydns.com = server:223.5.5.5
*.alicdn.com = server:223.5.5.5
*.aliyun.com = server:223.5.5.5
*.aliyuncdn.com = server:223.5.5.5
*.aliyundrive.com = server:223.5.5.5
# tencent
*.qq.com = server:119.29.29.29
*.qpic.cn = server:119.29.29.29
*.qlogo.cn = server:119.29.29.29
*.weixin.com = server:119.29.29.29
*.wechat.com = server:119.29.29.29
*.weiyun.com = server:119.29.29.29
*.qcloud.com = server:119.29.29.29
*.smtcdns.com = server:119.29.29.29
*.smtcdns.net = server:119.29.29.29
*.tencent.com = server:119.29.29.29
*.qcloudcdn.cn = server:119.29.29.29
*.qcloudcdn.com = server:119.29.29.29
# other
*.jd.com = server:119.29.29.29
*.mi.com = server:119.29.29.29
*.hdslb.com = server:119.29.29.29
*.xiaomi.com = server:119.29.29.29
*.bilibili.com = server:119.29.29.29
# netease
*.163.com = server:119.29.29.29
*.126.com = server:119.29.29.29
*.126.net = server:119.29.29.29
*.127.net = server:119.29.29.29
*.netease.com = server:119.29.29.29
# google
blog.google = server:94.140.15.15
talk.google.com = 108.177.125.188
mtalk.google.com = 108.177.125.188
dl.google.com = server:https://dns.adguard-dns.com/dns-query
dl.l.google.com = server:https://dns.adguard-dns.com/dns-query
update.googleapis.com = server:quic://dns.adguard-dns.com

#💡 url重写
[URL Rewrite]
^https?:\/\/(www.)?(g|google)\.cn https://www.google.com 302
^https?:\/\/(ditu|maps).google\.cn https://maps.google.com 302
(?<=_region=)CN(?=&) KR 307
(?<=&mcc_mnc=)4 2 307
^(https?:\/\/(tnc|dm)[\w-]+\.\w+\.com\/.+)(\?)(.+) $1$3 302
(^https?:\/\/*\.\w{4}okv.com\/.+&.+)(\d{2}\.3\.\d)(.+) $118.0$3 302

#💡 https解密,需安装证书并信任
[MITM]
hostname = *.tiktokv.com,*.byteoversea.com,*.tik-tokapi.com

#💡 脚本
[Script]
daily = type=cron,script-path=https://raw.githubusercontent.com/nzw9314/QuantumultX/master/yichahucha/cron_daily.js,cronexpr="30 7 * * *",script-update-interval=24,enable=true
time = type=cron,script-path=https://raw.githubusercontent.com/nzw9314/QuantumultX/master/Task/time.js,cronexpr="0 8 * * *",script-update-interval=24,enable=true
