// ==UserScript==
// @name         抖音下载无水印
// @version      1.0.0
// @description  一款短视频去水印下载工具
// @icon         data:image/png;base64,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
// @author       我爱工具箱
// @match      *://*.douyin.com/*
// @match      *://*.iesdouyin.com/*
// @require      https://lib.baomitu.com/jquery/3.6.0/jquery.js
// @require      https://lib.baomitu.com/sweetalert/2.1.2/sweetalert.min.js
// @require      https://lib.baomitu.com/clipboard.js/2.0.6/clipboard.min.js
// @grant        GM_addStyle
// @grant        GM_getValue
// @grant        GM_setValue
// @grant        GM_deleteValue
// @grant        GM_listValues
// @grant        GM_openInTab
// @grant        GM_notification
// @grant        GM_xmlhttpRequest
// @grant        GM_download
// @namespace https://greasyfork.org/users/894875
// ==/UserScript==

(function () {
    let isDouyinPage = function () {
        let url = location.href;
        if (url.indexOf("https://www.douyin.com/") != -1) 
        if (url.indexOf("https://www.iesdouyin.com/") != -1) {
            return true;
        } else {
            return false;
        }
    };

    let initButtonEvent = function () {
        if(isDouyinPage()){
            let videoUrl = decodeURI('https:' + document.getElementsByTagName("video")[0].getElementsByTagName("source")[0].getAttribute("src"));
            let videoName = document.getElementsByClassName("npIvCX5K")[0].childNodes[1].firstElementChild.firstElementChild.firstElementChild.firstElementChild.textContent;
            GM_download({url: videoUrl, name: videoName + '.mp4'});
        }
    };

    let sleep = function (time) {
        return new Promise(function (resolve) {
            setTimeout(resolve, time)
        });
    };

    let start = function () {
        if (!isDouyinPage()) {
            sleep(1000).then(function () {
                start();
            })
            return;
        }
        let btn = document.createElement('a');

        let btnShare = document.getElementsByClassName('OFZHdvpl')
        if(btnShare.length == 0) {
            btnShare = document.getElementsByClassName('Z1DFGRDj')
            if(btnShare.length == 0) {
                sleep(1000).then(() => {
                    start();
                })
                return;
            }
            btn.style.cssText = "padding-left: 10px;";
        }

        let btnDownload = {
            id: 'btnClickDownload',
            title: '点击下载视频',
            html: function () {
                return `<img height="26" width="26" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAABmJLR0QA/wD/AP+gvaeTAAAB10lEQVRYhe2Yv0sCYRjHnyuVoyIC/4CwH1OrKbdJDQ4hDi0NbTU0RuIPKKvBKE2loUHQ/0FRF3WsqDOoCF1UcIqWCvP0NC69hlI0Ss97LxR6P9sdPN/nw3vDPe8DMOAQUoTojy75n97HbBRyvgw1oIFvQ9v2vOGjJckdkiTlD8GCqGBBVLAgKlgQFSyIChZEBQuiggVRETRR6w+vTEDw7l7Df7sKAADwBOzErdRBtwzBd4alY9o6RsrstuW50YkRhdCyNoosB85gqlxk391Rs3ZfSM2w0PBsInAxubhev848UepZpYKUCy5tk2PKNU/UIkyuJ0EAgGzcfy5Gsshy4AylS0y55o1YNHu99OztGL4kVQvrfDL3RKlnlPJukkyFA1coxZZEyIkSBADIJPznU7o1SOaeO0oyFQ6cwRTLsDVv2KzZFdNLlOCnZOBMpVuDZO6Fmp9WyklFexRT4cAVTLNMteYNmzR2sX2QMXro7ZXTm/LdwxufL9T5fKHO3z++8au+25LBQzv6JtZKq6TUcpLsZgAADB7aMU7KNwkCiNcqdxLZ0m5LlS0ZRjd9YHTTXf8OGEwLBEDnqaOfxGwU0Ry3vi8g+01jATrwA+vACzY/sVQ75X/HB6W6vNjikAp7AAAAAElFTkSuQmCC"/>`;
            }
        }

        btn.id = btnDownload.id;
        btn.title = btnDownload.title;
        btn.innerHTML = btnDownload.html();
        btn.addEventListener('click', function (e) {
            initButtonEvent();
            e.preventDefault();
        });

        btnShare[0].appendChild(btn);
    }

    sleep(500).then(function () {
        start();
    })
})();
