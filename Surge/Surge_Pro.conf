
[General]
# 通用
internet-test-url = http://captive.apple.com/
proxy-test-url = http://cp.cloudflare.com/generate_204
# 测试超时（秒）
test-timeout = 3
# 默认向 8.8.8.8 查询 apple.com，可使用 proxy-test-udp 参数修改，如 proxy-test-udp = google.com@1.1.1.1
# proxy-test-udp = google.com@1.1.1.1
# WiFi 助手
wifi-assist = false
# 
# GeoIP 数据库
geoip-maxmind-url = https://github.com/Hackl0us/GeoIP2-CN/raw/release/Country.mmdb
# geoip-maxmind-url = https://cdn.jsdelivr.net/gh/alecthw/mmdb_china_ip_list@release/Country.mmdb
# 隐藏状态栏上的VPN图标
# hide-vpn-icon = true
# 是否启动完整的 IPv6 支持 (默认值: false)
ipv6 = true
# Wi-Fi 访问
# Surge 作为 HTTP/SOCKS5 代理服务器向 Wi-Fi 网络下的其他设备提供服务器
allow-wifi-access = true
# Surge Mac 供外网访问的服务端口
# HTTP 服务端口 (默认值: 6152)
# http-listen = 0.0.0.0:6152
# SOCKS5 服务端口 (默认值: 6153)
# socks5-listen = 0.0.0.0:6153
# Surge iOS 供外网访问的服务端口
# HTTP 服务端口 (默认值: 6152)
# wifi-access-http-port = 6152
# SOCKS5 服务端口 (默认值: 6153)
# wifi-access-socks5-port = 6153
# 远程控制器
# 允许外部控制器访问 Surge，Surge Dashboard 或 Surge CLI 进行管理控制
http-api = examplekey@0.0.0.0:6166
http-api-tls = false
http-api-web-dashboard = true
# Safari输入127.0.0.1:6171,填入HTTP-API密码即可。
skip-proxy = 10.0.0.0/8, 100.64.0.0/10, 127.0.0.1/32, 169.254.0.0/16, 172.16.0.0/12, 192.168.0.0/16, 224.0.0.0/3, ::1/128, fc00::/7, fe80::/10, localhost, *.local, *.crashlytics.com
# 兼容性（仅 iOS 版可用）
# compatibility-mode = 0
# 
# 跳过某个域名或者 IP 段，这些目标主机将不会由 Surge Proxy 处理。
# (macOS 版本中，如果启用了 Set as System Proxy, 这些值会被写入到系统网络代理设置.)
use-default-policy-if-wifi-not-primary = false
# 
# 当 Wi-Fi 不是首选网络时 SSID 组策略使用默认策略（仅 macOS 版可用）
# enhanced-mode-by-rule = false
# macOS Only
network-framework = false
# Network Framework
dns-server = 223.5.5.5, 119.29.29.29, system
# DNS 设置
# 强制使用特定的 DNS 服务器
read-etc-hosts = true
# > 从 /etc/hosts 读取 DNS 记录
#doh-server = h3://dns.alidns.com/dns-query,https://223.5.5.5/dns-query
# doh-server = https://223.5.5.5/dns-query
# doh-format = wireformat
# doh-server = https://public.dns.iij.jp/dns-query
doh-follow-outbound-mode = false
# 野比大佬的骚配置，先留下来供测试
# force-http-engine-hosts = %APPEND% *a, *b, *c, *d, *e, *f, *g, *h, *i, *j, *k, *l, *m, *n, *o, *p, *q, *r, *s, *t, *u, *v, *w, *x, *y, *z
force-http-engine-hosts = *.ott.cibntv.net, 119.18.193.135, 122.14.246.33, 123.59.31.1, 175.102.178.52, 116.253.24.*, 124.193.*, 124.14*, 119.79*, 175.6.26.*, 211.162.*, 220.112.* 220.169.153.*,
# TCP Force HTTP Hosts
# 让 Surge 把 TCP 连接当作 HTTP 请求来处理。 Surge HTTP 引擎将处理这些请求，所有的高级功能，如捕获、重写和脚本等都可以使用。
# KOOWO - 119.18.193.135, 122.14.246.33, 123.59.31.1, 175.102.178.52,
# TencentVideo/Youku/iQiyi - 116.253.24.*, 124.193.*, 124.14*, 119.79*, 175.6.26.*, 211.162.*, 220.112.* 220.169.153.*
# tun-excluded-routes = 239.255.255.250/32
# 
# VIF Excluded Routes
# Surge VIF 只能处理 TCP 和 UDP 协议。使用此选项可以绕过特定的 IP 范围，允许所有流量通过。
loglevel = notify
# 
# VIF Included Routes
# 默认情况下，Surge VIF 接口会声明自己是默认路由。但是，由于 Wi-Fi 接口的路由较小，有些流量可能不会通过 Surge VIF 接口。使用此选项可以添加一条较小的路由。
# tun-included-routes = 192.168.1.12/32
# 路由防火墙
# 包含所有的网络请求
# include-all-networks = false
# 包含本地网络请求
# include-local-networks = false
# 高级
# 日志等级: warning, notify, info, verbose (默认值: notify)
show-error-page-for-reject = true
exclude-simple-hostnames = true
# 排除简单主机名
hijack-dns = 8.8.8.8:53, 1.1.1.1:53
# Hijack DNS
# 默认情况下，Surge 只返回发送到 Surge DNS 地址的 DNS 查询的假 IP 地址(198.18.0.2)。
# 有些设备或软件总是使用硬编码的 DNS 服务器。 (例如 Google Speakers 总是使用 8.8.8.8)。 您可以使用此选项劫持查询，以获得一个假地址。
always-real-ip = *.srv.nintendo.net, *.stun.playstation.net, xbox.*.microsoft.com, *.xboxlive.com, *.nextdns.io, msftconnecttest.com, msftncsi.com, *.msftconnecttest.com, *.msftncsi.com, *.battlenet.com.cn, *.battlenet.com, *.battle.net, *.blzstatic.cn,*.brawlstars.com
# Always Real IP Hosts
# 当 Surge VIF 处理 DNS 问题时，此选项要求 Surge 返回一个真正的 IP 地址，而不是一个假 IP 地址。
# DNS 数据包将被转发到上游 DNS 服务器。
udp-policy-not-supported-behaviour = REJECT
# If use-local-host-item-for-proxy is true, Surge sends the proxy request with the IP address defined in the [Host] section, instead of the original domain.
# use-local-host-item-for-proxy = true
# 新增参数 udp-policy-not-supported-behaviour 参数用于控制当 UDP 流量被匹配到一个不支持 UDP 转发的策略时的行为
# DIRECT：回退到 DIRECT 策略（默认）
# REJECT：回退到 REJECT 策略
all-hybrid = true
# 开启后，等同于对所有策略设置 hybrid = true，所有 TCP 连接在建立时均会并发尝试数据网络和 WiFi 连接。
# 除此之外，所有 DNS 查询操作也都将并发在数据网络和 WiFi 上进行。所以若想体验该功能，请手动配置公网 DNS，暂不支持 DOH。
allow-hotspot-access = true
# 允许热点共享
# 该段定义抓取流量的过滤
use-local-host-item-for-proxy = true

[Replica]
# ---(实验性功能)---
# 0 为关闭，1 为开启
# 隐藏所有发往 *.Apple.com 和 *.icloud.com 的请求
# （该选项只是在抓取结果中隐藏了请求）
hide-apple-request = 1
# 隐藏 Crashlytics 请求
hide-crash-reporter-request = 1
# 隐藏 UDP 会话
hide-udp = 0
# 关键词过滤器
# none（关闭关键词过滤器） / whitelist（blacklist（仅记录包含关键字的请求）） / blacklist（仅记录不包含关键字的请求） / pattern（匹配通配符的请求）
keyword-filter-type = none
# 关键词
# keyword-filter = (null)
# ------

[Proxy]
# > 别名策略+代理
Direct = direct
Reject = reject

[Proxy Group]
Proxy = select, Hong Kong, FlowerCloud, Taiwan, Singapore, Japan, USA, Korea, Germany, Other, no-alert=0, hidden=0, include-all-proxies=0
# 香港
Hong Kong = fallback, policy-path=机场订阅, policy-regex-filter=Hong Kong, update-interval=43200, no-alert=0, hidden=1, include-all-proxies=0
# 台湾
Taiwan = fallback, policy-path=机场订阅, policy-regex-filter=Taiwan, update-interval=43200, no-alert=0, hidden=1, include-all-proxies=0
# 新加坡
Singapore = fallback, policy-path=机场订阅, policy-regex-filter=Singapore, update-interval=43200, no-alert=0, hidden=1, include-all-proxies=0
# 日本
Japan = fallback, policy-path=机场订阅, policy-regex-filter=Japan, update-interval=43200, no-alert=0, hidden=1, include-all-proxies=0
# 德国
Germany = fallback, policy-path=机场订阅, policy-regex-filter=Germany, update-interval=43200, no-alert=0, hidden=1, include-all-proxies=0
# 美国
USA = fallback, policy-path=机场订阅, policy-regex-filter=USA, update-interval=43200, no-alert=0, hidden=1, include-all-proxies=0
# 韩国
Korea = fallback, policy-path=机场订阅, policy-regex-filter=Korea, update-interval=43200, no-alert=0, hidden=1, include-all-proxies=0
# 其它地区
Other = select, policy-path=机场订阅, policy-regex-filter=^((?!Hong Kong|Taiwan|Singapore|Japan|Korea|USA|Germany).)*$, update-interval=43200, no-alert=0, hidden=0, include-all-proxies=0

FlowerCloud = select, policy-path=机场订阅, update-interval=0, policy-regex-filter=实验性, no-alert=0, hidden=0, include-all-proxies=0

[Rule]
DOMAIN-SUFFIX,imgcache.qq.com,REJECT-TINYGIF // Added for: imgcache.qq.com:80 (http://imgcache.qq.com/zljk/one.png)
DOMAIN-SUFFIX,imtmp.net,REJECT-TINYGIF // Added for: 1656235567.2782638423.sngdia.imtmp.net:80 (http://1656235567.2782638423.sngdia.imtmp.net/s)
DOMAIN-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/AdvertisingLite/AdvertisingLite_Domain.list,REJECT-TINYGIF
# > 规则分流
# 规则修正
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Unbreak.list,Direct
# 广告拦截
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/Advertising.list,REJECT-TINYGIF
RULE-SET,https://raw.githubusercontent.com/ExaAlice/Sources/master/Rule/Adblock.list,REJECT-TINYGIF
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/AdvertisingLite/AdvertisingLite.list,REJECT-TINYGIF
# 腾讯
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Tencent/Tencent.list,Direct
# 阿里巴巴
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Alibaba/Alibaba.list,Direct
# 推特
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Twitter/Twitter.list,Proxy
# Pixiv
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Pixiv/Pixiv.list,Proxy
# 电报分流
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Telegram/Telegram.list,𝗣𝗥𝗢𝗫𝗬
# Google mtakl
RULE-SET,https://raw.githubusercontent.com/ExaAlice/Sources/master/Rule/Googlemtalk.list,Direct
# 域名拦截
DOMAIN-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/AdvertisingPlus.list,REJECT
# 隐私保护
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/Privacy.list,REJECT-TINYGIF
# 运营商劫持
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/Hijacking.list,REJECT-TINYGIF
# 哔哩哔哩
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/BiliBili/BiliBili.list,Direct
# YouTube
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/StreamingMedia/Video/YouTube.list,𝗣𝗥𝗢𝗫𝗬
# 苹果服务
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Extra/Apple/Apple.list,Apple

# Local Area Network 局域网
RULE-SET,LAN,Direct
# GeoIP China
GEOIP,CN,Direct,dns-failed
FINAL,Proxy,dns-failed

[Host]
# > DNS 映射
# IPv6
ip6-localhost = ::1
ip6-loopback = ::1
# DNS 服务器

[MITM]
# > VIF 对原始 TCP 流量进行解密
tcp-connection = true
# > CA 证书