var obj,url=$request.url,change=!1;try{obj=JSON.parse($response.body)}catch(i){console.log(i+"\n错误URL："+url),$done({})}if(url.includes("app.bilibili.com/x/v2/splash/list")){if(obj.data?.list){for(let i of obj.data.list)i.duration=0,i.begin_time=2240150400,i.end_time=2240150400;change=!0}}else if(url.includes("app.bilibili.com/x/v2/feed/index?")){if(obj.data?.items){let i=[];for(let t of obj.data.items)t.hasOwnProperty("banner_item")||t.hasOwnProperty("ad_info")||-1!==t.card_goto.indexOf("ad")||"small_cover_v2"!==t.card_type&&"large_cover_v1"!==t.card_type&&"large_cover_single_v9"!==t.card_type||i.push(t);obj.data.items=i,change=!0}}else if(url.includes("app.bilibili.com/x/v2/feed/index/story?")){if(obj.data?.items){let i=[];for(let t of obj.data.items)t.hasOwnProperty("ad_info")||-1!==t.card_goto.indexOf("ad")||i.push(t);obj.data.items=i,change=!0}}else if(url.includes("app.bilibili.com/x/resource/show/tab"))if(obj.data?.tab?.length<4)obj.data.tab.push({id:1411,tab_id:"bangumi",name:"动画",uri:"bilibili://following/home_activity_tab/6544",pos:4}),change=!0;else{const i=new Set([39,40,41,774,857,545,151,442,99,100,101,554,556]),t=new Set([176,107]),a=new Set([177,178,179,181,102,104,106,486,488,489]);obj.data?.tab&&(obj.data.tab=obj.data.tab.filter((t=>i.has(t.id))),change=!0);let e="246834163";obj.data?.top&&(obj.data.top=obj.data.top.filter((i=>(222!==i.id&&107!==i.id||(i.uri=`bilibili://story/${e}`,i.icon="https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/script/bilibili/bilibili_icon.png",i.tab_id="Story_Top",i.name="Story"),t.has(i.id)))),change=!0),obj.data?.bottom&&(obj.data.bottom=obj.data.bottom.filter((i=>a.has(i.id))),change=!0)}else if(url.includes("app.bilibili.com/x/v2/account/mine")){if(obj.data?.sections_v2){const i=new Set([396,397,398,399,402,404,407,410,425,426,427,428,430,432,433,434,494,495,496,497,500,501]);obj.data.sections_v2.forEach(((t,a)=>{t.items.forEach((i=>{622===i.id&&(i.title="会员购",i.uri="bilibili://mall/home")}));let e=t.items.filter((t=>i.has(t.id)));obj.data.sections_v2[a].button={},obj.data.sections_v2[a].be_up_title=void 0,obj.data.sections_v2[a].tip_icon=void 0,obj.data.sections_v2[a].tip_title=void 0;for(let i=0;i<obj.data.sections_v2.length;i++)"创作中心"!=obj.data.sections_v2[i].title&&"創作中心"!=obj.data.sections_v2[i].title||(obj.data.sections_v2[i].title=void 0,obj.data.sections_v2[i].type=void 0);obj.data.vip_section_v2=void 0,obj.data.vip_section=void 0,obj.data.sections_v2[a].items=e,obj.data.hasOwnProperty("live_tip")&&(obj.data.live_tip={}),obj.data.hasOwnProperty("answer")&&(obj.data.answer={})})),change=!0}}else url.includes("app.bilibili.com/x/v2/account/myinfo?")?obj.data?.vip&&(obj.data.vip.type=2,obj.data.vip.status=1,obj.data.vip.vip_pay_type=1,obj.data.vip.due_date=4669824160,change=!0):url.includes("app.bilibili.com/x/v2/search/square")?(obj.data={type:"history",title:"搜索历史",search_hotword_revision:2},change=!0):url.includes("api.live.bilibili.com/xlive/app-room/v1/index/getInfoByRoom")?obj.data&&(obj.data.activity_banner_info=void 0,change=!0):url.includes("pgc/page/bangumi")||url.includes("pgc/page/cinema/tab?")?obj.result?.modules&&(obj.result.modules.forEach((i=>{i.style.startsWith("banner")&&(i.items=i.items.filter((i=>!(-1==i.link.indexOf("play"))))),i.style.startsWith("function")&&(i.items=i.items.filter((i=>-1==i.blink.indexOf("www.bilibili.com")))),i.style.startsWith("tip")&&(i.items=[])})),change=!0):console.log("触发意外的请求，请确认脚本或复写配置是否正常\n错误URL："+url);change?$done({body:JSON.stringify(obj)}):$done({});